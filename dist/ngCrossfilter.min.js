/*! ng-crossfilter by Adam Timberlake <adam.timberlake@gmail.com> created on 2013-11-28 */
!function(a,b){"use strict";var c=a.module("ngCrossfilter",[]);c.service("crossfilterFilter",function(){var c={},d={},e=null,f="",g="afresh",h=[],i=function(f){var g=k(f[0]);c=b(f),a.forEach(g,function(a){e||(e=a),d[a]=c.dimension(function(b){return b[a]})}),a.forEach(f,function(a){h.push(a[e])})},j=function(b){var d=[];return a.forEach(b,function(a){-1===h.indexOf(a[e])&&(d.push(a),h.push(a[e]))}),c.add(d),d.length},k=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},l=function(b,c,e){"afresh"===e&&f&&d[f].filterAll(),f=b;var g=d[b],h=function(a){return a.substr(1)};if(a.isArray(c))return g.filterRange(c),void 0;switch(String(c).charAt(0)){case"!":q(g,h(c));break;case"?":n(g,h(c));break;case"^":o(g,h(c));break;case"~":r(g,h(c));break;default:p(g,c)}},m=function(){a.forEach(d,function(a){a.filterAll()})},n=function(a,b){var c=new RegExp(b,"i");a.filterFunction(function(a){return String(a).match(c)})},o=function(a,b){var c=new RegExp(b,"i");a.filterFunction(function(a){return!String(a).match(c)})},p=function(a,b){var c=new RegExp(b,"i");a.filterFunction(function(a){return a.match(c)})},q=function(a,b){var c=new RegExp(b,"i");a.filterFunction(function(a){return!a.match(c)})},r=function(a,b){var c=b.match(/\/([a-z])*$/)[1];b=b.match(/^\/(.+?)\/[a-z]*$/i)[1];var d=new RegExp(b,c);a.filterFunction(function(a){return a.match(d)})};return function(a,b,c,e,f,k){if(!a.length)return a;c===!1&&m(),0===h.length&&i(a),h.length!==a.length&&j(a),c&&(k=k||g,l(b,c,k));var n=d[e||"id"],o="asc"===(f||"asc")?"bottom":"top";return n[o](1/0)}})}(window.angular,window.crossfilter);