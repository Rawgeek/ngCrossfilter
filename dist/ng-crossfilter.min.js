/*! ng-crossfilter by Adam Timberlake <adam.timberlake@gmail.com> created on 2014-05-28 */
!function(a,b,c,d){"use strict";var e=function(a){throw"ngCrossfilter: "+a+"."};"undefined"==typeof a&&e("Angular dependency is a requirement"),"undefined"==typeof b&&e("Crossfilter dependency is a requirement");var f=a.module("ngCrossfilter",[]);f.filter("crossfilter",function(){return function(a){if(a._debug&&d.time("timeTaken"),"undefined"==typeof a._collection)return a._debug&&d.timeEnd("timeTaken"),a;var b=a._sortProperty||a._primaryKey,c=a._isAscending?"top":"bottom",e=a._dimensions[b][c](1/0);return a._debug&&d.timeEnd("timeTaken"),e}}),f.service("Crossfilter",function(){var d=function(a,b,c){this._initialise(a,b,c)};return d.prototype={STRATEGY_PERSISTENT:"persistent",STRATEGY_TRANSIENT:"transient",_collection:{},_dimensions:[],_primaryKey:"",_sortProperty:"",_isAscending:!0,_lastFilter:"",_strategy:"",_debug:!1,_initialise:function(d,f,g){"function"!=typeof c.isArray||c.isArray(d)||e("Collection must be an array"),g=g||this.STRATEGY_PERSISTENT,-1===[this.STRATEGY_PERSISTENT,this.STRATEGY_TRANSIENT].indexOf(g)&&e("Strategy must be either '"+this.STRATEGY_PERSISTENT+"' or '"+this.STRATEGY_TRANSIENT+"'");var h=this._getProperties(d[0]);this._collection=b(d),this._strategy=g,this._primaryKey=f||h[0],a.forEach(h,function(a){this._dimensions[a]=this._collection.dimension(function(b){return b[a]})}.bind(this))},filterBy:function(a,b,c){if("undefined"!=typeof c&&"function"!=typeof c)throw e("Custom filter method must be a function");return this._lastFilter&&this._strategy===this.STRATEGY_TRANSIENT&&(this.unfilterBy(this._lastFilter),this._lastFilter=a),"function"==typeof c?void this._dimensions[a].filterFunction(c):void this._dimensions[a].filter(b)},unfilterBy:function(a){this._assertDimensionExists(a),this._dimensions[a].filterAll()},unfilterAll:function(){a.forEach(this._dimensions,function(a){a.filterAll()})},sortBy:function(a,b){return this._assertDimensionExists(a),"boolean"==typeof b?(this._isAscending=b,void(this._sortProperty=a)):(this._sortProperty===a&&(this._isAscending=!this._isAscending),void(this._sortProperty=a))},unsortBy:function(a,b){this._assertDimensionExists(a),this._sortProperty!==a&&e("Currently not sorting by property '"+a+"'"),this._sortProperty=this._primaryKey,b!==!0&&(this._isAscending=!0)},debugMode:function(a){this._debug=!!a},_assertDimensionExists:function(a){"undefined"==typeof this._dimensions[a]&&e("Unable to find dimension named '"+a+"'")},_getProperties:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}},d})}(window.angular,window.crossfilter,window.Array,window.console);